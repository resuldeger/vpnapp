{"dependencies":[{"name":"@babel/runtime/helpers/interopRequireDefault","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"kslwqCIsh6ew+I1KeA1rlVRjsAk=","exportNames":["*"]}},{"name":"util","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":24,"index":24}}],"key":"Bf9PtPW7+veKQMh7B7ds7b1JRAE=","exportNames":["*"]}},{"name":"stream","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":25},"end":{"line":2,"column":32,"index":57}}],"key":"zqzemo30Pa+agKo6Jlvuf3baHHA=","exportNames":["*"]}},{"name":"../utils.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":58},"end":{"line":3,"column":32,"index":90}}],"key":"dGswK136diHRCgUa8xpQUn/UMbc=","exportNames":["*"]}},{"name":"./readBlob.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":91},"end":{"line":4,"column":37,"index":128}}],"key":"DoTfyulefU1cu3RiyrUi5ZFie6o=","exportNames":["*"]}},{"name":"../platform/index.js","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":5,"column":0,"index":129},"end":{"line":5,"column":44,"index":173}}],"key":"T7TU1TBYuangUQrrpmlcbtGpNpE=","exportNames":["*"]}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  var _interopRequireDefault = require(_dependencyMap[0], \"@babel/runtime/helpers/interopRequireDefault\");\n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.default = void 0;\n  var _util = _interopRequireDefault(require(_dependencyMap[1], \"util\"));\n  var _stream = require(_dependencyMap[2], \"stream\");\n  var _utils = _interopRequireDefault(require(_dependencyMap[3], \"../utils.js\"));\n  var _readBlob = _interopRequireDefault(require(_dependencyMap[4], \"./readBlob.js\"));\n  var _index = _interopRequireDefault(require(_dependencyMap[5], \"../platform/index.js\"));\n  const BOUNDARY_ALPHABET = _index.default.ALPHABET.ALPHA_DIGIT + '-_';\n  const textEncoder = typeof TextEncoder === 'function' ? new TextEncoder() : new _util.default.TextEncoder();\n  const CRLF = '\\r\\n';\n  const CRLF_BYTES = textEncoder.encode(CRLF);\n  const CRLF_BYTES_COUNT = 2;\n  class FormDataPart {\n    constructor(name, value) {\n      const {\n        escapeName\n      } = this.constructor;\n      const isStringValue = _utils.default.isString(value);\n      let headers = `Content-Disposition: form-data; name=\"${escapeName(name)}\"${!isStringValue && value.name ? `; filename=\"${escapeName(value.name)}\"` : ''}${CRLF}`;\n      if (isStringValue) {\n        value = textEncoder.encode(String(value).replace(/\\r?\\n|\\r\\n?/g, CRLF));\n      } else {\n        headers += `Content-Type: ${value.type || \"application/octet-stream\"}${CRLF}`;\n      }\n      this.headers = textEncoder.encode(headers + CRLF);\n      this.contentLength = isStringValue ? value.byteLength : value.size;\n      this.size = this.headers.byteLength + this.contentLength + CRLF_BYTES_COUNT;\n      this.name = name;\n      this.value = value;\n    }\n    async *encode() {\n      yield this.headers;\n      const {\n        value\n      } = this;\n      if (_utils.default.isTypedArray(value)) {\n        yield value;\n      } else {\n        yield* (0, _readBlob.default)(value);\n      }\n      yield CRLF_BYTES;\n    }\n    static escapeName(name) {\n      return String(name).replace(/[\\r\\n\"]/g, match => ({\n        '\\r': '%0D',\n        '\\n': '%0A',\n        '\"': '%22'\n      })[match]);\n    }\n  }\n  const formDataToStream = (form, headersHandler, options) => {\n    const {\n      tag = 'form-data-boundary',\n      size = 25,\n      boundary = tag + '-' + _index.default.generateString(size, BOUNDARY_ALPHABET)\n    } = options || {};\n    if (!_utils.default.isFormData(form)) {\n      throw TypeError('FormData instance required');\n    }\n    if (boundary.length < 1 || boundary.length > 70) {\n      throw Error('boundary must be 10-70 characters long');\n    }\n    const boundaryBytes = textEncoder.encode('--' + boundary + CRLF);\n    const footerBytes = textEncoder.encode('--' + boundary + '--' + CRLF);\n    let contentLength = footerBytes.byteLength;\n    const parts = Array.from(form.entries()).map(([name, value]) => {\n      const part = new FormDataPart(name, value);\n      contentLength += part.size;\n      return part;\n    });\n    contentLength += boundaryBytes.byteLength * parts.length;\n    contentLength = _utils.default.toFiniteNumber(contentLength);\n    const computedHeaders = {\n      'Content-Type': `multipart/form-data; boundary=${boundary}`\n    };\n    if (Number.isFinite(contentLength)) {\n      computedHeaders['Content-Length'] = contentLength;\n    }\n    headersHandler && headersHandler(computedHeaders);\n    return _stream.Readable.from(async function* () {\n      for (const part of parts) {\n        yield boundaryBytes;\n        yield* part.encode();\n      }\n      yield footerBytes;\n    }());\n  };\n  var _default = exports.default = formDataToStream;\n});","lineCount":93,"map":[[7,2,1,0],[7,6,1,0,"_util"],[7,11,1,0],[7,14,1,0,"_interopRequireDefault"],[7,36,1,0],[7,37,1,0,"require"],[7,44,1,0],[7,45,1,0,"_dependencyMap"],[7,59,1,0],[8,2,2,0],[8,6,2,0,"_stream"],[8,13,2,0],[8,16,2,0,"require"],[8,23,2,0],[8,24,2,0,"_dependencyMap"],[8,38,2,0],[9,2,3,0],[9,6,3,0,"_utils"],[9,12,3,0],[9,15,3,0,"_interopRequireDefault"],[9,37,3,0],[9,38,3,0,"require"],[9,45,3,0],[9,46,3,0,"_dependencyMap"],[9,60,3,0],[10,2,4,0],[10,6,4,0,"_readBlob"],[10,15,4,0],[10,18,4,0,"_interopRequireDefault"],[10,40,4,0],[10,41,4,0,"require"],[10,48,4,0],[10,49,4,0,"_dependencyMap"],[10,63,4,0],[11,2,5,0],[11,6,5,0,"_index"],[11,12,5,0],[11,15,5,0,"_interopRequireDefault"],[11,37,5,0],[11,38,5,0,"require"],[11,45,5,0],[11,46,5,0,"_dependencyMap"],[11,60,5,0],[12,2,7,0],[12,8,7,6,"BOUNDARY_ALPHABET"],[12,25,7,23],[12,28,7,26,"platform"],[12,42,7,34],[12,43,7,35,"ALPHABET"],[12,51,7,43],[12,52,7,44,"ALPHA_DIGIT"],[12,63,7,55],[12,66,7,58],[12,70,7,62],[13,2,9,0],[13,8,9,6,"textEncoder"],[13,19,9,17],[13,22,9,20],[13,29,9,27,"TextEncoder"],[13,40,9,38],[13,45,9,43],[13,55,9,53],[13,58,9,56],[13,62,9,60,"TextEncoder"],[13,73,9,71],[13,74,9,72],[13,75,9,73],[13,78,9,76],[13,82,9,80,"util"],[13,95,9,84],[13,96,9,85,"TextEncoder"],[13,107,9,96],[13,108,9,97],[13,109,9,98],[14,2,11,0],[14,8,11,6,"CRLF"],[14,12,11,10],[14,15,11,13],[14,21,11,19],[15,2,12,0],[15,8,12,6,"CRLF_BYTES"],[15,18,12,16],[15,21,12,19,"textEncoder"],[15,32,12,30],[15,33,12,31,"encode"],[15,39,12,37],[15,40,12,38,"CRLF"],[15,44,12,42],[15,45,12,43],[16,2,13,0],[16,8,13,6,"CRLF_BYTES_COUNT"],[16,24,13,22],[16,27,13,25],[16,28,13,26],[17,2,15,0],[17,8,15,6,"FormDataPart"],[17,20,15,18],[17,21,15,19],[18,4,16,2,"constructor"],[18,15,16,13,"constructor"],[18,16,16,14,"name"],[18,20,16,18],[18,22,16,20,"value"],[18,27,16,25],[18,29,16,27],[19,6,17,4],[19,12,17,10],[20,8,17,11,"escapeName"],[21,6,17,21],[21,7,17,22],[21,10,17,25],[21,14,17,29],[21,15,17,30,"constructor"],[21,26,17,41],[22,6,18,4],[22,12,18,10,"isStringValue"],[22,25,18,23],[22,28,18,26,"utils"],[22,42,18,31],[22,43,18,32,"isString"],[22,51,18,40],[22,52,18,41,"value"],[22,57,18,46],[22,58,18,47],[23,6,20,4],[23,10,20,8,"headers"],[23,17,20,15],[23,20,20,18],[23,61,20,59,"escapeName"],[23,71,20,69],[23,72,20,70,"name"],[23,76,20,74],[23,77,20,75],[23,81,21,6],[23,82,21,7,"isStringValue"],[23,95,21,20],[23,99,21,24,"value"],[23,104,21,29],[23,105,21,30,"name"],[23,109,21,34],[23,112,21,37],[23,127,21,52,"escapeName"],[23,137,21,62],[23,138,21,63,"value"],[23,143,21,68],[23,144,21,69,"name"],[23,148,21,73],[23,149,21,74],[23,152,21,77],[23,155,21,80],[23,157,21,82],[23,160,22,7,"CRLF"],[23,164,22,11],[23,166,22,13],[24,6,24,4],[24,10,24,8,"isStringValue"],[24,23,24,21],[24,25,24,23],[25,8,25,6,"value"],[25,13,25,11],[25,16,25,14,"textEncoder"],[25,27,25,25],[25,28,25,26,"encode"],[25,34,25,32],[25,35,25,33,"String"],[25,41,25,39],[25,42,25,40,"value"],[25,47,25,45],[25,48,25,46],[25,49,25,47,"replace"],[25,56,25,54],[25,57,25,55],[25,71,25,69],[25,73,25,71,"CRLF"],[25,77,25,75],[25,78,25,76],[25,79,25,77],[26,6,26,4],[26,7,26,5],[26,13,26,11],[27,8,27,6,"headers"],[27,15,27,13],[27,19,27,17],[27,36,27,34,"value"],[27,41,27,39],[27,42,27,40,"type"],[27,46,27,44],[27,50,27,48],[27,76,27,74],[27,79,27,77,"CRLF"],[27,83,27,81],[27,85,27,83],[28,6,28,4],[29,6,30,4],[29,10,30,8],[29,11,30,9,"headers"],[29,18,30,16],[29,21,30,19,"textEncoder"],[29,32,30,30],[29,33,30,31,"encode"],[29,39,30,37],[29,40,30,38,"headers"],[29,47,30,45],[29,50,30,48,"CRLF"],[29,54,30,52],[29,55,30,53],[30,6,32,4],[30,10,32,8],[30,11,32,9,"contentLength"],[30,24,32,22],[30,27,32,25,"isStringValue"],[30,40,32,38],[30,43,32,41,"value"],[30,48,32,46],[30,49,32,47,"byteLength"],[30,59,32,57],[30,62,32,60,"value"],[30,67,32,65],[30,68,32,66,"size"],[30,72,32,70],[31,6,34,4],[31,10,34,8],[31,11,34,9,"size"],[31,15,34,13],[31,18,34,16],[31,22,34,20],[31,23,34,21,"headers"],[31,30,34,28],[31,31,34,29,"byteLength"],[31,41,34,39],[31,44,34,42],[31,48,34,46],[31,49,34,47,"contentLength"],[31,62,34,60],[31,65,34,63,"CRLF_BYTES_COUNT"],[31,81,34,79],[32,6,36,4],[32,10,36,8],[32,11,36,9,"name"],[32,15,36,13],[32,18,36,16,"name"],[32,22,36,20],[33,6,37,4],[33,10,37,8],[33,11,37,9,"value"],[33,16,37,14],[33,19,37,17,"value"],[33,24,37,22],[34,4,38,2],[35,4,40,2],[35,11,40,9,"encode"],[35,17,40,15,"encode"],[35,18,40,15],[35,20,40,17],[36,6,41,4],[36,12,41,10],[36,16,41,14],[36,17,41,15,"headers"],[36,24,41,22],[37,6,43,4],[37,12,43,10],[38,8,43,11,"value"],[39,6,43,16],[39,7,43,17],[39,10,43,20],[39,14,43,24],[40,6,45,4],[40,10,45,7,"utils"],[40,24,45,12],[40,25,45,13,"isTypedArray"],[40,37,45,25],[40,38,45,26,"value"],[40,43,45,31],[40,44,45,32],[40,46,45,34],[41,8,46,6],[41,14,46,12,"value"],[41,19,46,17],[42,6,47,4],[42,7,47,5],[42,13,47,11],[43,8,48,6],[43,15,48,13],[43,19,48,13,"readBlob"],[43,36,48,21],[43,38,48,22,"value"],[43,43,48,27],[43,44,48,28],[44,6,49,4],[45,6,51,4],[45,12,51,10,"CRLF_BYTES"],[45,22,51,20],[46,4,52,2],[47,4,54,2],[47,11,54,9,"escapeName"],[47,21,54,19,"escapeName"],[47,22,54,20,"name"],[47,26,54,24],[47,28,54,26],[48,6,55,6],[48,13,55,13,"String"],[48,19,55,19],[48,20,55,20,"name"],[48,24,55,24],[48,25,55,25],[48,26,55,26,"replace"],[48,33,55,33],[48,34,55,34],[48,44,55,44],[48,46,55,47,"match"],[48,51,55,52],[48,55,55,58],[49,8,56,8],[49,12,56,12],[49,14,56,15],[49,19,56,20],[50,8,57,8],[50,12,57,12],[50,14,57,15],[50,19,57,20],[51,8,58,8],[51,11,58,11],[51,13,58,14],[52,6,59,6],[52,7,59,7],[52,9,59,8,"match"],[52,14,59,13],[52,15,59,15],[52,16,59,16],[53,4,60,2],[54,2,61,0],[55,2,63,0],[55,8,63,6,"formDataToStream"],[55,24,63,22],[55,27,63,25,"formDataToStream"],[55,28,63,26,"form"],[55,32,63,30],[55,34,63,32,"headersHandler"],[55,48,63,46],[55,50,63,48,"options"],[55,57,63,55],[55,62,63,60],[56,4,64,2],[56,10,64,8],[57,6,65,4,"tag"],[57,9,65,7],[57,12,65,10],[57,32,65,30],[58,6,66,4,"size"],[58,10,66,8],[58,13,66,11],[58,15,66,13],[59,6,67,4,"boundary"],[59,14,67,12],[59,17,67,15,"tag"],[59,20,67,18],[59,23,67,21],[59,26,67,24],[59,29,67,27,"platform"],[59,43,67,35],[59,44,67,36,"generateString"],[59,58,67,50],[59,59,67,51,"size"],[59,63,67,55],[59,65,67,57,"BOUNDARY_ALPHABET"],[59,82,67,74],[60,4,68,2],[60,5,68,3],[60,8,68,6,"options"],[60,15,68,13],[60,19,68,17],[60,20,68,18],[60,21,68,19],[61,4,70,2],[61,8,70,5],[61,9,70,6,"utils"],[61,23,70,11],[61,24,70,12,"isFormData"],[61,34,70,22],[61,35,70,23,"form"],[61,39,70,27],[61,40,70,28],[61,42,70,30],[62,6,71,4],[62,12,71,10,"TypeError"],[62,21,71,19],[62,22,71,20],[62,50,71,48],[62,51,71,49],[63,4,72,2],[64,4,74,2],[64,8,74,6,"boundary"],[64,16,74,14],[64,17,74,15,"length"],[64,23,74,21],[64,26,74,24],[64,27,74,25],[64,31,74,29,"boundary"],[64,39,74,37],[64,40,74,38,"length"],[64,46,74,44],[64,49,74,47],[64,51,74,49],[64,53,74,51],[65,6,75,4],[65,12,75,10,"Error"],[65,17,75,15],[65,18,75,16],[65,58,75,56],[65,59,75,57],[66,4,76,2],[67,4,78,2],[67,10,78,8,"boundaryBytes"],[67,23,78,21],[67,26,78,24,"textEncoder"],[67,37,78,35],[67,38,78,36,"encode"],[67,44,78,42],[67,45,78,43],[67,49,78,47],[67,52,78,50,"boundary"],[67,60,78,58],[67,63,78,61,"CRLF"],[67,67,78,65],[67,68,78,66],[68,4,79,2],[68,10,79,8,"footerBytes"],[68,21,79,19],[68,24,79,22,"textEncoder"],[68,35,79,33],[68,36,79,34,"encode"],[68,42,79,40],[68,43,79,41],[68,47,79,45],[68,50,79,48,"boundary"],[68,58,79,56],[68,61,79,59],[68,65,79,63],[68,68,79,66,"CRLF"],[68,72,79,70],[68,73,79,71],[69,4,80,2],[69,8,80,6,"contentLength"],[69,21,80,19],[69,24,80,22,"footerBytes"],[69,35,80,33],[69,36,80,34,"byteLength"],[69,46,80,44],[70,4,82,2],[70,10,82,8,"parts"],[70,15,82,13],[70,18,82,16,"Array"],[70,23,82,21],[70,24,82,22,"from"],[70,28,82,26],[70,29,82,27,"form"],[70,33,82,31],[70,34,82,32,"entries"],[70,41,82,39],[70,42,82,40],[70,43,82,41],[70,44,82,42],[70,45,82,43,"map"],[70,48,82,46],[70,49,82,47],[70,50,82,48],[70,51,82,49,"name"],[70,55,82,53],[70,57,82,55,"value"],[70,62,82,60],[70,63,82,61],[70,68,82,66],[71,6,83,4],[71,12,83,10,"part"],[71,16,83,14],[71,19,83,17],[71,23,83,21,"FormDataPart"],[71,35,83,33],[71,36,83,34,"name"],[71,40,83,38],[71,42,83,40,"value"],[71,47,83,45],[71,48,83,46],[72,6,84,4,"contentLength"],[72,19,84,17],[72,23,84,21,"part"],[72,27,84,25],[72,28,84,26,"size"],[72,32,84,30],[73,6,85,4],[73,13,85,11,"part"],[73,17,85,15],[74,4,86,2],[74,5,86,3],[74,6,86,4],[75,4,88,2,"contentLength"],[75,17,88,15],[75,21,88,19,"boundaryBytes"],[75,34,88,32],[75,35,88,33,"byteLength"],[75,45,88,43],[75,48,88,46,"parts"],[75,53,88,51],[75,54,88,52,"length"],[75,60,88,58],[76,4,90,2,"contentLength"],[76,17,90,15],[76,20,90,18,"utils"],[76,34,90,23],[76,35,90,24,"toFiniteNumber"],[76,49,90,38],[76,50,90,39,"contentLength"],[76,63,90,52],[76,64,90,53],[77,4,92,2],[77,10,92,8,"computedHeaders"],[77,25,92,23],[77,28,92,26],[78,6,93,4],[78,20,93,18],[78,22,93,20],[78,55,93,53,"boundary"],[78,63,93,61],[79,4,94,2],[79,5,94,3],[80,4,96,2],[80,8,96,6,"Number"],[80,14,96,12],[80,15,96,13,"isFinite"],[80,23,96,21],[80,24,96,22,"contentLength"],[80,37,96,35],[80,38,96,36],[80,40,96,38],[81,6,97,4,"computedHeaders"],[81,21,97,19],[81,22,97,20],[81,38,97,36],[81,39,97,37],[81,42,97,40,"contentLength"],[81,55,97,53],[82,4,98,2],[83,4,100,2,"headersHandler"],[83,18,100,16],[83,22,100,20,"headersHandler"],[83,36,100,34],[83,37,100,35,"computedHeaders"],[83,52,100,50],[83,53,100,51],[84,4,102,2],[84,11,102,9,"Readable"],[84,27,102,17],[84,28,102,18,"from"],[84,32,102,22],[84,33,102,24],[84,52,102,43],[85,6,103,4],[85,11,103,8],[85,17,103,14,"part"],[85,21,103,18],[85,25,103,22,"parts"],[85,30,103,27],[85,32,103,29],[86,8,104,6],[86,14,104,12,"boundaryBytes"],[86,27,104,25],[87,8,105,6],[87,15,105,13,"part"],[87,19,105,17],[87,20,105,18,"encode"],[87,26,105,24],[87,27,105,25],[87,28,105,26],[88,6,106,4],[89,6,108,4],[89,12,108,10,"footerBytes"],[89,23,108,21],[90,4,109,2],[90,5,109,3],[90,6,109,5],[90,7,109,6],[90,8,109,7],[91,2,110,0],[91,3,110,1],[92,2,110,2],[92,6,110,2,"_default"],[92,14,110,2],[92,17,110,2,"exports"],[92,24,110,2],[92,25,110,2,"default"],[92,32,110,2],[92,35,112,15,"formDataToStream"],[92,51,112,31],[93,0,112,31],[93,3]],"functionMap":{"names":["<global>","FormDataPart","FormDataPart#constructor","FormDataPart#encode","FormDataPart.escapeName","String.replace$argument_1","formDataToStream","Array.from.map$argument_0","<anonymous>"],"mappings":"AAA;ACc;ECC;GDsB;EEE;GFY;EGE;8CCC;eDI;GHC;CDC;yBME;+CCmB;GDI;wBEgB;GFO;CNC"}},"type":"js/module"}]}